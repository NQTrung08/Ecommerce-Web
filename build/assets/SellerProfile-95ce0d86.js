import{j as e,P as g}from"./mui-a50be5b6.js";import{T as $,C as B}from"./Trend-c0506e69.js";import{S as b}from"./Spring-81dcc22e.js";import{L as I}from"./LabeledProgressBar-7c59dd6a.js";import{R as A}from"./RatingStars-a495c0a4.js";import{h as w,N as E,u as W,L as G}from"./index-cacf817c.js";import{g as X,n as v}from"./helpers-f9dc12f1.js";import{g as _}from"./review-704be748.js";import{r as i,N as j,J as K}from"./antd-4509dcf0.js";import{I as U}from"./InfoBtn-50190647.js";import{R as z,A as H,C as J,X as V,Y as q,T as Q,c as Z}from"./recharts-19f32df2.js";import{a as ee}from"./statistic-cd42dafa.js";import{s as se}from"./categorie-7552cc64.js";import{g as te}from"./shop-074a834f.js";import"./config-e16ab0ea.js";const ae=()=>{const t=["accent","red","header","yellow","green","orange"];return t[Math.floor(Math.random()*t.length)]},re=({statisticCategory:t})=>{const{id:s}=w(),[a,l]=i.useState([]),r=t.map(o=>({...o,color:ae()})).map(o=>({label:o.categoryName,value:o.totalRevenue,color:o.color})),h=a.length>0?(a.reduce((o,n)=>o+n.rating,0)/a.length).toFixed(1):"0.0";return i.useEffect(()=>{(async()=>{try{const n=await _(s);l(n)}catch(n){console.error("Lỗi khi lấy đánh giá:",n)}})()},[s]),e.jsxs(b,{className:"card flex flex-col",children:[e.jsx("h5",{className:"mb-4",children:"Doanh thu ngành hàng"}),e.jsxs("div",{className:"flex flex-1 flex-col gap-[27px] justify-between",children:[e.jsx("div",{className:"flex flex-col gap-4",children:r.length!==0?r.map((o,n)=>e.jsx(I,{label:o.label,value:X(r,o.value),color:o.color,displayValue:v(o.value,2)},n)):e.jsx("div",{className:"text-rose-500 flex text-center text-xl w-full justify-center",children:"Chưa có dữ liệu"})}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("h5",{children:["Đánh giá ",h," trên 5"]}),e.jsx(A,{value:h})]}),e.jsxs("div",{className:"sm:text-right",children:[e.jsxs("p",{className:"text-sm text-header sm:mb-1.5",children:["Từ ",a.length," người phản hồi"]}),e.jsx(E,{className:"text-btn",to:`/reviews/${s}`,children:"Xem tất cả đánh giá"})]})]})]})]})},le=t=>(console.log("revenueData",t),t.map((s,a,l)=>{var n;const c=s.totalRevenue,r=((n=l[a-1])==null?void 0:n.totalRevenue)||c,h=(c-r)/Math.abs(r||1)*100;return{date:s.day?new Date(new Date().getFullYear(),s.month-1,s.day):new Date(new Date().getFullYear(),s.month-1),value:c,trend:parseFloat(h.toFixed(2))}})),oe=({active:t,payload:s,label:a})=>{if(t&&s&&s.length){const l=a instanceof Date?a.toString():a,r=l.includes(" ")?j(l).format("DD MMM, YYYY"):j(l).format("MMM, YYYY");return e.jsxs("div",{className:"chart-tooltip px-[14px] py-5 flex flex-col",children:[e.jsx("h6",{children:"Doanh thu vào:"}),e.jsx("span",{className:"my-1",children:r}),e.jsx($,{value:s[0].payload.trend}),e.jsx("span",{className:"h3 mt-2",children:v(s[0].value,1)})]})}return null},ne=({revenueData:t})=>{const{width:s}=W(),a=le(t);return e.jsxs(b,{className:"card flex flex-col h-[300px] md:h-[494px] lg:h-[400px] xl:h-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("h4",{children:"Doanh thu"}),e.jsx(U,{})]}),e.jsx("div",{className:"flex-1 -mt-5 overflow-hidden",children:e.jsx(z,{width:"99%",height:"100%",children:e.jsxs(H,{data:a,margin:{top:5,right:10,left:10,bottom:5},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"area",x1:"610.509",y1:"172.326",x2:"610.509",y2:"38.1836",gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{stopColor:"var(--accent)",stopOpacity:"0.01"}),e.jsx("stop",{offset:"1",stopColor:"var(--accent)",stopOpacity:"0.175261"})]})}),e.jsx(J,{strokeDasharray:"0",stroke:"var(--input-border)",strokeOpacity:"0.6",vertical:!1}),e.jsx(V,{dataKey:"date",tickLine:!1,axisLine:!1,dy:9,hide:s<768||s>=1024&&s<1280,tick:{fill:"var(--header)"},tickFormatter:l=>l.getDate()?j(l).format("DD/MM"):j(l).format("MM/YYYY")}),e.jsx(q,{tickLine:!1,axisLine:!1,hide:s<768,dx:-20,tickFormatter:l=>v(l,0)}),e.jsx(Q,{cursor:{strokeDasharray:"4 4",stroke:"var(--header)"},content:e.jsx(oe,{})}),e.jsx(Z,{type:"monotone",dataKey:"value",stroke:"var(--accent)",strokeWidth:6,strokeLinecap:"round",fill:"url(#area)",dot:{r:4,fill:"var(--green)",stroke:"var(--header)",strokeWidth:1,fillOpacity:1},activeDot:{r:6,fill:"var(--green)",stroke:"var(--header)"}})]})})})]})},N=({icon:t="diamond",color:s="accent",value:a=0,label:l="Lorem",withCurrency:c=!0})=>e.jsxs(b,{className:"card !py-5 !px-[22px] flex items-center gap-3",children:[e.jsx("div",{className:`badge-icon bg-${s}`,children:e.jsx("i",{className:K(`icon-${t}`,{"text-[23px] mt-1":t==="diamond","text-lg":t==="tax"})})}),e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsxs("span",{className:"h4",children:[c&&"$",v(a,1)]}),e.jsx("span",{className:"label-text",children:l})]})]});N.propTypes={icon:g.oneOf(["diamond","barcode","tax"]),color:g.string,value:g.number,label:g.string,withCurrency:g.bool};const ie=({wrapperClass:t,dataTotalRevenue:s,dataTotalOrders:a})=>e.jsxs("div",{className:"grid w-full grid-cols-2 gap-5",children:[e.jsx(N,{value:s,label:"Tổng doanh thu"}),e.jsx(N,{icon:"barcode",color:"green",value:a,label:"Tổng đơn hàng",withCurrency:!1})]}),De=()=>{const{id:t}=w(),[s,a]=i.useState(!0),[l,c]=i.useState(null),[r,h]=i.useState(null),[o,n]=i.useState([]),[D,S]=i.useState([]),[C,R]=i.useState([]),[k,Y]=i.useState([]),[f,T]=i.useState({startDate:"2023-01-01",endDate:"2024-12-31"}),F=(m,p)=>{const d=new Date(m);return(new Date(p)-d)/(1e3*60*60*24)>30?"month":"day"},M=async(m,p)=>{try{a(!0);const d=await te(t);h(d);const u=F(m,p),x=await ee({id:t,startDate:m,endDate:p,groupBy:u}),y=await se(t);Y(y),R(x.breakdown),n(x.totalRevenue),S(x.totalOrders)}catch(d){c("Failed to fetch data."),console.error(d)}finally{a(!1)}};i.useEffect(()=>{M(f.startDate,f.endDate)},[f]);const L=({startDate:m,endDate:p})=>{const d=u=>{const x=new Date(u),y=x.getFullYear(),P=String(x.getMonth()+1).padStart(2,"0"),O=String(x.getDate()).padStart(2,"0");return`${y}-${P}-${O}`};T({startDate:d(m),endDate:d(p)})};return s?e.jsx(G,{}):l?e.jsx("div",{children:l}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white shadow-xl rounded-lg overflow-hidden border border-gray-200 mb-5",children:[e.jsxs("div",{className:"relative bg-gradient-to-r from-purple-500 to-pink-500 text-white p-6",children:[e.jsx("img",{src:r.shop.logo,alt:`${r.shop.shop_name} logo`,className:"absolute top-6 left-6 w-24 h-24 rounded-full border-4 border-white shadow-lg"}),e.jsxs("div",{className:"ml-32",children:[e.jsx("h1",{className:"text-3xl font-bold",children:r.shop.shop_name}),e.jsx("p",{className:"mt-1 text-sm italic",children:r.shop.description}),e.jsxs("p",{className:"mt-2 text-sm",children:[e.jsx("span",{className:"font-medium",children:"Trạng thái: "}),e.jsx("span",{className:`px-2 py-1 rounded-full ${r.shop.status==="active"?"bg-green-500 text-white":"bg-red-500 text-white"}`,children:r.shop.status==="active"?"Hoạt động":"Ngừng hoạt động"})]})]})]}),e.jsxs("div",{className:"p-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 text-blue-600 rounded-full flex justify-center items-center",children:e.jsx("i",{className:"fas fa-map-marker-alt"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-600 uppercase",children:"Địa chỉ"}),e.jsx("p",{className:"text-base text-gray-800",children:r.shop.address})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 text-green-600 rounded-full flex justify-center items-center",children:e.jsx("i",{className:"fas fa-phone-alt"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-600 uppercase",children:"Số điện thoại"}),e.jsx("p",{className:"text-base text-gray-800",children:r.shop.phone_number})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-yellow-100 text-yellow-600 rounded-full flex justify-center items-center",children:e.jsx("i",{className:"fas fa-box"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-600 uppercase",children:"Số sản phẩm"}),e.jsx("p",{className:"text-base text-gray-800",children:r.productsCount})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-red-100 text-red-600 rounded-full flex justify-center items-center",children:e.jsx("i",{className:"fas fa-star"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-600 uppercase",children:"Số đánh giá"}),e.jsx("p",{className:"text-base text-gray-800",children:r.reviewsCount})]})]})]})]}),e.jsx("div",{className:"flex flex-col gap-4 mb-5 md:mb-[26px] md:gap-5 lg:flex-row lg:justify-between",children:e.jsx(B,{wrapperClass:"md:max-w-[275px]",id:"sellerPeriodSelector",onDateChange:L,selectedDates:f})}),e.jsx("div",{className:"widgets-grid grid-cols-1 md:grid-cols-3 2xl:grid-cols-6 mb-10",children:e.jsxs("div",{className:"widgets-grid grid-cols-1 md:col-span-3 lg:grid-cols-2 2xl:col-span-6",children:[e.jsx(ne,{revenueData:C}),e.jsxs("div",{className:"widgets-grid grid-cols-1",children:[e.jsx(ie,{dataTotalRevenue:o,dataTotalOrders:D}),e.jsx(re,{statisticCategory:k})]})]})})]})};export{De as default};
