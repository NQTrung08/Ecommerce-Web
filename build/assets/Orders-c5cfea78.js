import{P as b,j as e}from"./mui-a50be5b6.js";import{P as D}from"./PageHeader-2b351038.js";import{S as A}from"./Spring-81dcc22e.js";import{C as E}from"./Counter-dfd40b33.js";import{S as R}from"./SubmenuTrigger-9cf6148c.js";import{r as t,N,P as U}from"./antd-4509dcf0.js";import{k as I,i as L,P as $,O as F,L as H}from"./index-cacf817c.js";/* empty css                      */import{U as Y,a as B}from"./config-e16ab0ea.js";import"./DocumentTitle-0f80adc2.js";import"./helpers-f9dc12f1.js";const u=({icon:n,color:r="accent",title:c="Lorem ipsum",count:o=0})=>e.jsxs(A,{className:"card !pb-5",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("div",{className:"badge-icon badge-icon--sm",style:{backgroundColor:`var(--${r})`},children:n}),e.jsx(R,{})]}),e.jsxs("h6",{className:"mt-[28px] mb-2.5",children:[e.jsx("span",{className:"xl:hidden 2xl:inline",children:"Orders "}),c]}),e.jsx(E,{className:"h3",num:o})]});u.propTypes={icon:b.node,color:b.oneOf(["accent","green","red","badge-status-bg"]),title:b.string,count:b.number};const M=({initialOrders:n})=>{const[r,c]=t.useState(n),[o,y]=t.useState(""),[i,p]=t.useState(""),[m,v]=t.useState(1),[l]=t.useState(10),g=r.filter(s=>{const j=N(s.createdAt),S=o?j.isAfter(N(o).subtract(1,"day")):!0,O=i?j.isBefore(N(i).add(1,"day")):!0;return S&&O}),f=g.slice((m-1)*l,m*l),h=s=>{v(s)};return e.jsxs("div",{className:"space-y-6 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"mb-4 flex space-x-4",children:[e.jsxs("div",{className:"w-full",children:[e.jsx("label",{htmlFor:"start-date",className:"block text-lg font-medium text-gray-700",children:"Ngày bắt đầu:"}),e.jsx("input",{type:"date",id:"start-date",className:"mt-1 block w-full border-2 border-gray-300 p-2 rounded-md shadow-sm focus:ring focus:ring-indigo-200",value:o,onChange:s=>y(s.target.value)})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("label",{htmlFor:"end-date",className:"block text-lg font-medium text-gray-700",children:"Ngày kết thúc:"}),e.jsx("input",{type:"date",id:"end-date",className:"mt-1 block w-full border-2 border-gray-300 p-2 rounded-md shadow-sm focus:ring focus:ring-indigo-200",value:i,onChange:s=>p(s.target.value)})]})]}),f.length===0?e.jsx("p",{className:"text-gray-600 text-center",children:"Không có đơn hàng nào để hiển thị."}):f.map(s=>e.jsx("div",{className:"border-b py-4 px-6 bg-white rounded-lg shadow-md",children:e.jsx("div",{className:"flex justify-between items-start",children:e.jsxs("div",{className:"w-full",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:["Mã đơn hàng:"," ",e.jsx("span",{className:"text-blue-600",children:s.order_trackingNumber})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Ngày tạo: ",N(s.createdAt).format("DD/MM/YYYY")]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Trạng thái:"," ",e.jsx("span",{className:"font-medium",children:s.order_status})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Địa chỉ giao hàng: ",s.order_shipping_address]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Phương thức thanh toán:"," ",e.jsx("span",{className:"font-medium",children:s.order_payment_method.toUpperCase()})]}),e.jsxs("p",{className:"text-sm font-semibold text-gray-800",children:["Tổng tiền:"," ",e.jsxs("span",{className:"text-red-600",children:[s.order_total_price.toLocaleString(),"₫"]})]})]})})},s._id)),e.jsx(U,{current:m,total:g.length,pageSize:l,onChange:h,showSizeChanger:!1,className:"mt-4"}),e.jsx(I,{})]})},C=async n=>{try{const r=L("application/json"),c=`${Y}order${n?`?status=${n}`:""}`;return(await B.get(c,r)).data}catch(r){throw console.error("Failed to fetch orders:",r),r}},se=()=>{const[n,r]=t.useState($[0]),[c,o]=t.useState(F[0]),[y,i]=t.useState([]),[p,m]=t.useState([]),[v,l]=t.useState(!0),[g,f]=t.useState(null),[h,s]=t.useState("pending"),[j,S]=t.useState([]),O=[{value:"",name:"Tất cả đơn hàng"},{value:"pending",name:"Chờ xử lý"},{value:"confirmed",name:"Đã xác nhận"},{value:"shipped",name:"Đang vận chuyển"},{value:"completed",name:"Hoàn thành"},{value:"canceled",name:"Đã hủy"},{value:"waiting",name:"Chờ thanh toán"}];t.useEffect(()=>{(async()=>{l(!0);try{const d=await C(h),w=await C();i(d),m(w)}catch(d){console.error("Error fetching orders:",d),f("Không thể tải đơn hàng. Vui lòng thử lại.")}finally{l(!1)}})()},[h]);const T=a=>{S(d=>[...d,a])},P=y.filter(a=>!j.includes(a.id)),x=a=>p.filter(w=>w.order_status===a).length,_=()=>O.map(a=>e.jsx("button",{onClick:()=>s(a.value),className:`py-2 px-4 rounded-lg text-sm ${h===a.value?"bg-blue-500 text-white":"bg-slate-100 text-gray-700 border-slate-200 border-2"}`,children:a.name},a.value));console.log("first",p,x("completed"));const k=()=>e.jsxs("div",{className:"widgets-grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 xl:col-span-4",children:[e.jsx(u,{title:"Hoàn thành",count:x("completed"),icon:e.jsx("i",{className:"icon-check-to-slot-solid"})}),e.jsx(u,{title:"Chờ xác nhận",count:x("pending"),color:"badge-status-bg",icon:e.jsx("i",{className:"icon-rotate-left-solid"})}),e.jsx(u,{title:"Đã xác nhận",count:x("confirmed"),color:"green",icon:e.jsx("i",{className:"icon-list-check-solid"})}),e.jsx(u,{title:"Đã hủy",count:x("canceled"),color:"red",icon:e.jsx("i",{className:"icon-ban-solid"})})]});return e.jsxs(e.Fragment,{children:[e.jsx(D,{title:"Đơn Hàng"}),e.jsxs("div",{className:"flex flex-col flex-1 gap-5 md:gap-[26px]",children:[e.jsx("div",{className:"w-full widgets-grid grid-cols-1 ",children:k()}),e.jsx("div",{className:"flex gap-4",children:_()}),v?e.jsx(H,{}):g?e.jsx("p",{className:"text-rose-500",children:g}):e.jsx(M,{initialOrders:P,category:n,sort:c,onOrderUpdate:T})]})]})};export{se as default};
