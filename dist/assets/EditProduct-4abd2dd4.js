import{h as w,j as e,Q as t}from"./index-c34e661e.js";import{P as S}from"./PageHeader-671d5d99.js";import{S as k}from"./Spring-024788c5.js";import{u as U,C as v}from"./index.esm-867dcdda.js";import{a as h,J as d}from"./antd-f8b54f9d.js";import{g as V}from"./categorie-c21aaf5e.js";import{g as T,u as D,c as y}from"./product-06714f6c.js";import"./mui-33c18219.js";import"./DocumentTitle-3f6fed6e.js";import"./config-6a5e32b1.js";const _=()=>{const{id:l}=w(),[P,x]=h.useState([]),[p,b]=h.useState([]),{register:n,handleSubmit:N,control:g,formState:{errors:m},setValue:c}=U({defaultValues:{image1:[],productName:"",description:"",salePrice:"",category_id:null,qty:0}});h.useEffect(()=>{const i=async()=>{try{const s=await V();x(s.filter(o=>o.value!=="all"))}catch{t.error("Không thể tải ngành hàng")}},r=async()=>{if(l)try{const s=await T(l);c("productName",s.product_name),c("description",s.product_desc),c("salePrice",s.product_price),c("category_id",s.category_id._id),c("qty",s.product_quantity);const o=s.product_img.map(u=>({url:u}));b(o),c("image1",o)}catch{t.error("Không thể tải dữ liệu sản phẩm")}};i(),r()},[l,c]);const E=async(i,r)=>{var o,u;const s=i.image1.filter(a=>a!=="");console.log(r);try{const W=await(l?D:y)({id:l,product_name:i.productName,product_desc:i.description,product_price:i.salePrice,product_quantity:i.qty,category_id:i.category_id,files:s,isDraft:r,isPublic:!r});r?t.info("Sản phẩm đã được lưu dưới dạng bản nháp!"):t.success(`Sản phẩm đã ${l?"cập nhật":"xuất bản"} thành công!`),console.log("Product response:",W)}catch(a){t.error(`Không thể ${r?"lưu sản phẩm dưới dạng bản nháp":"xuất bản sản phẩm"}. Lý do: ${((u=(o=a.response)==null?void 0:o.data)==null?void 0:u.message)||a.message}`)}},f=i=>{const r=Array.from(i);b(r),c("image1",r)},j=i=>{const r=p.filter((s,o)=>o!==i);b(r),c("image1",r)};return e.jsxDEV(k,{className:"card flex-1 xl:py-10",children:[e.jsxDEV("h5",{className:"mb-[15px]",children:l?"Chỉnh sửa sản phẩm":"Cài đặt sản phẩm"},void 0,!1,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:101,columnNumber:7},globalThis),e.jsxDEV("form",{className:"grid gap-5",onSubmit:N(i=>E(i,!1)),children:e.jsxDEV("div",{className:"flex flex-row w-full gap-4",children:[e.jsxDEV("div",{className:"w-1/2",children:[e.jsxDEV("div",{className:"field-wrapper",children:[e.jsxDEV("label",{className:"field-label",htmlFor:"productName",children:"Tên sản phẩm"},void 0,!1,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:109,columnNumber:15},globalThis),e.jsxDEV("input",{className:d("field-input",{"field-input--error":m.productName}),id:"productName",placeholder:"Nhập tên sản phẩm",...n("productName",{required:!0})},void 0,!1,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:112,columnNumber:15},globalThis)]},void 0,!0,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:108,columnNumber:13},globalThis),e.jsxDEV("div",{className:"field-wrapper",children:[e.jsxDEV("label",{className:"field-label",htmlFor:"description",children:"Mô tả"},void 0,!1,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:121,columnNumber:15},globalThis),e.jsxDEV("textarea",{className:d("field-input",{"field-input--error":m.description}),id:"description",placeholder:"Nhập mô tả",...n("description",{required:!0})},void 0,!1,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:124,columnNumber:15},globalThis)]},void 0,!0,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:120,columnNumber:13},globalThis),e.jsxDEV("div",{className:"field-wrapper",children:[e.jsxDEV("label",{className:"field-label",htmlFor:"salePrice",children:"Giá bán"},void 0,!1,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:133,columnNumber:15},globalThis),e.jsxDEV("input",{className:d("field-input",{"field-input--error":m.salePrice}),id:"salePrice",type:"number",placeholder:"Nhập giá bán",...n("salePrice",{required:!0})},void 0,!1,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:136,columnNumber:15},globalThis)]},void 0,!0,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:132,columnNumber:13},globalThis),e.jsxDEV("div",{children:[e.jsxDEV("label",{className:"field-label mb-2.5",children:"Hình ảnh sản phẩm"},void 0,!1,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:145,columnNumber:15},globalThis),e.jsxDEV(v,{name:"image1",control:g,render:({field:i})=>e.jsxDEV("div",{className:"border-2 border-slate-200 rounded-lg p-4",children:[e.jsxDEV("label",{htmlFor:"image-upload",className:"btn btn-primary cursor-pointer",children:"Choose Image"},void 0,!1,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:150,columnNumber:21},globalThis),e.jsxDEV("input",{id:"image-upload",type:"file",name:"image1",onChange:r=>f(r.target.files),multiple:!0,className:"hidden"},void 0,!1,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:153,columnNumber:21},globalThis),e.jsxDEV("div",{className:"image-preview-container mt-4",children:p.map((r,s)=>e.jsxDEV("div",{className:"image-preview relative w-full h-48 border border-slate-300 rounded-lg overflow-hidden flex justify-center items-center",children:r?e.jsxDEV("img",{src:r.url||URL.createObjectURL(r),alt:`preview-${s}`,className:"preview-img object-cover w-full h-full cursor-pointer",onClick:()=>j(s)},void 0,!1,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:158,columnNumber:36},globalThis):e.jsxDEV("label",{htmlFor:`image-upload-${s}`,className:"media-dropzone w-full h-full flex justify-center items-center cursor-pointer border-2 border-dashed border-slate-300 rounded-lg",children:[e.jsxDEV("span",{className:"text-gray-500",children:"Select Image"},void 0,!1,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:159,columnNumber:31},globalThis),e.jsxDEV("input",{id:`image-upload-${s}`,type:"file",name:`image${s+1}`,onChange:o=>f(o.target.files),className:"hidden"},void 0,!1,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:162,columnNumber:31},globalThis)]},void 0,!0,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:158,columnNumber:218},globalThis)},s,!1,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:157,columnNumber:60},globalThis))},void 0,!1,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:156,columnNumber:21},globalThis)]},void 0,!0,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:148,columnNumber:19},globalThis)},void 0,!1,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:146,columnNumber:15},globalThis)]},void 0,!0,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:144,columnNumber:13},globalThis)]},void 0,!0,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:106,columnNumber:11},globalThis),e.jsxDEV("div",{className:"w-1/2",children:[e.jsxDEV("div",{className:"field-wrapper",children:[e.jsxDEV("label",{className:"field-label",htmlFor:"qty",children:"Số lượng"},void 0,!1,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:173,columnNumber:15},globalThis),e.jsxDEV("input",{className:d("field-input",{"field-input--error":m.qty}),id:"qty",type:"number",placeholder:"Nhập số lượng",...n("qty",{required:!0})},void 0,!1,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:176,columnNumber:15},globalThis)]},void 0,!0,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:172,columnNumber:13},globalThis),e.jsxDEV("div",{className:"field-wrapper",children:[e.jsxDEV("label",{className:"field-label",htmlFor:"category",children:"Ngành hàng"},void 0,!1,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:185,columnNumber:15},globalThis),e.jsxDEV(v,{name:"category_id",control:g,render:({field:i})=>e.jsxDEV("select",{className:d("field-input",{"field-input--error":m.category_id}),id:"category",...i,children:[e.jsxDEV("option",{value:"",children:"Chọn ngành hàng"},void 0,!1,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:193,columnNumber:21},globalThis),P.map(r=>e.jsxDEV("option",{value:r._id,children:r.category_name},r._id,!1,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:194,columnNumber:49},globalThis))]},void 0,!0,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:190,columnNumber:19},globalThis)},void 0,!1,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:188,columnNumber:15},globalThis)]},void 0,!0,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:184,columnNumber:13},globalThis),e.jsxDEV("div",{className:"grid gap-2 mt-5 sm:grid-cols-2 sm:mt-10 md:mt-11",children:[l?null:e.jsxDEV("button",{type:"button",className:"btn btn--primary",onClick:N(i=>E(i,!0)),children:"Lưu thành bản nháp"},void 0,!1,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:201,columnNumber:22},globalThis),e.jsxDEV("button",{className:"btn btn--secondary",type:"submit",children:l?"Cập nhật thông tin":"Xuất bản sản phẩm"},void 0,!1,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:205,columnNumber:15},globalThis)]},void 0,!0,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:200,columnNumber:13},globalThis)]},void 0,!0,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:170,columnNumber:11},globalThis)]},void 0,!0,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:105,columnNumber:9},globalThis)},void 0,!1,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:104,columnNumber:7},globalThis)]},void 0,!0,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/widgets/ProductEditor.jsx",lineNumber:100,columnNumber:10},globalThis)},z=()=>e.jsxDEV(e.Fragment,{children:[e.jsxDEV(S,{title:"Product Editor"},void 0,!1,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/pages/EditProduct.jsx",lineNumber:6,columnNumber:13},globalThis),e.jsxDEV(_,{},void 0,!1,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/pages/EditProduct.jsx",lineNumber:7,columnNumber:13},globalThis)]},void 0,!0,{fileName:"/Users/manh/WorkSpoce/Private/Ecommerce-Web/src/pages/EditProduct.jsx",lineNumber:5,columnNumber:10},globalThis);export{z as default};
